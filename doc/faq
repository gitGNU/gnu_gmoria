Frequently Asked Questions for rec.games.roguelike.moria

Last changes:   10/30/10: Removed reference Umoria 5.5.0 source 
                10/30/10: Removed reference to KSU mirror
                10/30/10: Changed references to treasure.c to treasure_tables.c
                10/30/10: Updated file where TV_WAND can be found
                10/30/10: Removed dead Imoria link to ubvms.cc.buffalo.edu
                10/30/10: Removed references to dead jyu.fi mac version link
                10/30/10: Removed dead ftp mirror planetmirror
                10/30/10: Added a question about Moria's licensing
                10/30/10: Added Umoria version 5.7 to the list of versions
                10/30/10: Replacing greyhelm.com ftp with funet.fi ftp site
                10/30/10: Updated the address for lars' site
                10/30/10: Removed chungkuo.org telnet server
                10/30/10: Updated the address for beej's site
                10/30/10: Removed notice about compiling on 64-bit systems
                6/7/06: (Bug fix for compiling on 64-bit systems)
		4/21/05 (Color Moria for PC no longer available)
		2/7/05 (Mac OS X Moria available)
		
First, a general guideline for contributors.  When you post any question
related to playing or debugging the game, please give the version
number, which you can get during the game by pressing "v".

These are the questions in the Moria Frequently Asked Questions list.
Quick answers to some questions are given in parentheses; more detailed
answers to those questions with numbers are in the list which follows.

The answers below are separated by form feeds, so that in most news
readers, you can get the answer you want without looking at the rest of
the spoilers.  (Search for the string "Q5", for example.)

Many of the answers are only correct for Umoria versions (4.87 and 5.x);
I don't know much about the other versions of Moria.

Please send any corrections or other suggested questions to me at
grabiner@alumni.princeton.edu

The FAQ is now maintained on the Web at

<http://remarque.org/~grabiner/moriafaq.html>

A copy of the FAQ as it was last posted may be obtained by FTP from the
RTFM archive,

ftp://rtfm.mit.edu/pub/usenet/rec.games.roguelike.moria/rec.games.roguelike.moria_Frequently_Asked_Questions

or by using the mailserver on RTFM.  To use the mailserver, send a
message to mail-server@rtfm.mit.edu containing the line
"send /pub/usenet/rec.games.roguelike.moria/rec.games.roguelike.moria_Frequently_Asked_Questions"

There is also a WWW page for Moria, with links to the spoilers, newsgroup,
this FAQ, and the FTP site.  It is

<http://beej.us/moria>

The most common questions, asked by both beginners and others:

Q1. How do I get the Moria sources/executables/documentation? 
(PC executables are available at
<http://www3.ns.sympatico.ca/dmswaine/m552-386.zip>, 
<http://www.oocities.com/lhelgeland/umoria.html>
GNU+Linux source is available at
<http://packages.debian.org/moria>.
FreeBSD Moria is at
<http://www.freebsd.org/cgi/ports.cgi?query=Moria&stype=all>.
Sources and other executables are on the main archive at
<ftp://ftp.funet.fi/pub/unix/games/moria>.) 

Q2. What is the license that UMoria is distributed with?

Umoria is now licensed under the terms of the GNU GPL (General Public License)
version 3.  You can see the full text of the license at
<http://www.gnu.org/licenses/gpl.html>

Q3. I can't get Moria/Angband set up on my machine; is there a server on
another machine that I can use?  (No.)

What does this item do?  (Answer is below with the spoilers.)

Why do most winning characters carry several copies of spell books?
(In case one gets stolen.)

What does the (-2) in Chain Mail (-2) [14,+2] mean?  (It's a penalty to
hit, caused by the heavy armor.)

Q4. How do I use wizard mode, and what can I do in it?  (In 5.x, just type
control-W.)

Non-spoiler questions:

Q5. How does resistance work?  Are two items of resistance cumulative?
(Not if both are worn items.)

Q6. How does speed work?  Do you get faster if you are already Very Fast
and get another speed item?  (Yes.)

Q7. I'm playing Moria version V; how does that compare to the current
version?  Is it compatible?

Q8. I think I've found a bug; what should I do?  (Check that it isn't
already known, then report it with the version number and system.) 

Common spoiler requests:

Q9. What are the special abilities of ego weapons?  Crowns?  Amulet of
the Magi?  Cloak of Protection? 

Q10. How much damage do spells and wands do?

Q11. What does spell Y do?

Q12. On what level do you find X?  (Level 25 is best for gain stat potions.) 

Q13. How many attacks can I get with this weapon?

Q14. How do you kill an ancient multi-hued dragon?  (Usually, you don't.)

Q15. How do you kill an emperor lich?  (With speed and spells.)

Q16. What is the grape jelly trick?  Does it work in Umoria 5.x?  (No.)

Questions related to the source code:

Q17. I don't like haggling; can I change the source code to turn it off?

Q18. How do you create objects in wizard mode?

Q1. How do I get the Moria sources/executables/documentation?  


Pre-compiled executables are not yet available for Umoria 5.7.

A working version of UMoria 5.5.2 is now available for the PC; it's also
available at the main Moria archive, but this URL is more likely to
work.

http://www3.ns.sympatico.ca/dmswaine/m552-386.zip

A version with a few additional features is available at:

http://www.oocities.com/lhelgeland/umoria.html

GNU+Linux sources (designed for Debian, but they also work on Red Hat at
least) are at

http://packages.debian.org/moria

Sources for FreeBSD are at

http://www.freebsd.org/cgi/ports.cgi?query=Moria&stype=all.

UMoria 5.5.2 is available for Mac OS X (search for "Moria")

http://fink.sourceforge.net

Umoria 5.5.2 has been ported to the PalmOS at

http://roguelike-palm.sourceforge.net/kMoria/index.php

The main Moria archive has moved to a new home; it makes files available
by anoymous FTP:

ftp://ftp.funet.fi/pub/unix/games/moria

One mirror is available.

http://beej.us/moria/files/

Use the pathnames listed below, ignoring the leading /pub/unix/games/moria.
Some files on the mirrors may be compressed with different compression
programs such as gzip.

The documentation, including the official manual and this FAQ, is
available at
http://beej.us/moria/

The following paths give the structure of the Moria archive; they will
probably be maintained when the archive moves somewhere else.

/pub/games/unix/moria/[machine name]
Executables for the Amiga, Atari ST, IBM PC, and Mac; look at the README
files in these directories for more information.  Some of these files
may need to be transferred in binary mode; type "binary" before
transferring the files.  There are both color and monochrome executables
for the IBM PC.

/pub/unix/games/moria/pc/80386-5.5.2/m552-386.zip
This is the 5.5.2 executable for the PC.

/pub/unix/games/moria/source/um5.5.2.tar.Z 
A compressed tar file containing the entire source, for use on any
system; if you have tar on your system, this is probably the file that
you want.  (If you don't have compress, you can FTP it as well; it is
/pub/Games/Moria/compress.tar.)  This file must be transferred in binary
mode; type "binary" before getting the file.  Once you have the tar.Z
file, type "zcat um5.5.2.tar.Z | tar xf -" to extract the files, and
read the README files for help in installing.

/pub/unix/games/moria/pc/zip-arc/mor55src.zip
A ZIP file containing the source.

/pub/unix/games/moria/pc/zip-arc/wmoria10.zip_exec.gz
/pub/unix/games/moria/pc/zip-arc/wmoria10.zip_source.gz
Source and Modula-2 executables for Wmoria 1.0, a port of Umoria 5.5.0 to
Windows 3.1.

/pub/unix/games/moria/patches
Patches for upgrading Moria from one version the the next version, and
for modifications.  This does not include a patch to upgrade version 5.5.2 to
5.7.

/pub/unix/games/moria/XMoria/xm1.07.tar.Z
The source to Moria for X Windows.

/pub/unix/games/moria/doc
The documentation for Moria 5.7, including the official documentation,
the FAQ file, and a complete monster list.

/pub/unix/games/moria/pc/mono5.5 
The auxilliary files are in this directory; you may need them if you
have an executable without them.

/pub/unix/games/angband
The source to Angband for UNIX, and source and executable for the PC and
Mac.

/pub/unix/games/moria/boss
The source distribution, in Pascal, for BOSS.

/pub/unix/games/moria/vms
The source discribution, in Pascal, for VMS Moria 4.8 and 5.0.  Umoria
5.5.2 will also work on VMS machines, but Umoria 5.7 will not.  (Note that 
VMS Moria 5.0 is not a version of Umoria 5.x.)

/pub/unix/games/moria/unofficial
Other unofficial modifications of Moria, including JAMoria, the druid
version for the PC, and the sources for Morgul and Pmoria.

/pub/unix/games/moria/utils/calchits.shar.Z
A program for calculating the average damage done with various weapons,
allowing you to compare them.

GNU+Linux code for Imoria is available from
http://www.angelfire.com/games3/imoria/imoria.html.

Q2. What is the license that UMoria is distributed with?

There is an article about the effort to relicense Umoria at
http://www.freesoftwaremagazine.com/articles/freeing_an_old_game_moria

Umoria is now licensed under the terms of the GNU GPL (General Public License)
version 3.  You can see the full text of the license at
http://www.gnu.org/licenses/gpl.html

The previous license for moria was non-commerical in nature, and therefore 
did not qualify as a free software license.


Q3. I can't get Moria/Angband set up on my machine; is there a server on
another machine that I can use?  (No.)

In the past there were servers available, but none exist today.  If you
know of a public Umoria server, please contact me at
grabiner@alumni.princeton.edu


Q4. How do I use wizard mode, and what can I do in it?  

In Umoria 5.x, anyone can use wizard mode by typing ^W.  However,
characters who play in wizard mode are permanently barred from the
scoreboard; wizard mode should be used only for debugging and
experimenting.

In 4.87 on Unix systems, only the person who installed the game can use
wizard mode; if you are the installer, the passwords are in the source
file constants.h.

In PC-Moria 4.8x, you need to know the passwords to use wizard mode, and
the password will depend on who compiled your game.

4.87 has both wizard and god modes; 5.x's wizard mode is equivalent to
the old god mode.  The 4.87 wizard mode allows you to do only things
related to the game (cure all problems, teleport, identify).  The 5.x
wizard mode and 4.87 god mode allow you to test the program by editing
your character, creating objects, deleting monsters, and similar things.

In wizard mode, ^H or DELETE will give you a list of the available
commands.

Q5. How does resistance work?  Are two items of resistance cumulative?

Resist heat/cold potions and spells give temporary resistance to heat or
cold.  All other resistance items give permanent resistance.  Two
permanent resistances are not cumulative, and two temporary resistances
are cumulative only in duration.

Fire and cold do 1/3 damage if you have single resistance, 1/9 if you
have double.
Acid does 1/2 damage if you have any armor to corrode, 1/3 if you have
resistance but no armor, and 1/4 if you have resistance and armor.
Lightning does 1/3 damage if you have resistance.
There is no resistance against poison gas.

Q6. How does speed work?  Do you get faster if you are already Very Fast
and get another speed item?  

Very Fast is the highest speed that can be displayed, but if you are
fortunate enough to find several speed items, you can get still faster.
Permanent speed items (rings and boots) are cumulative, and temporary
speed (potions, spells, and staffs) can add one more point to your
speed.  Multiple uses of temporary speed are cumulative only in
duration.

Q7. I'm playing Moria version V; how does that compare to the current
version?  Is it compatible?

Moria versions:

Umoria 5.7.0: This is the current version of Umoria.  It will accept
characters from all Umoria 5.x versions.  It is essentially identical to
5.5.2, but drops support for many unpopular computing platforms.

Umoria 5.5.2: This version was the latest version of Umoria for 16 years.
It was the last version to support VMS.

Umoria 5.3.0-5.5.1: These are essentially identical to 5.5.2, and
compatible with it, although 5.5.2 fixes a few bugs, and there have been
a few minor changes.  Upgrading from 5.5.1 to 5.5.2 is probably not
necessary; upgrading from earlier versions is recommended.

Umoria 5.2.2: This is in good condition, and compatible with the current
version.  One bug: don't rest more than 10,000 turns in place, and leave
the level if you start seeing lots of "Compacting monsters..."
messages, or the game may lock up.

Umoria 5.2.1: This is playable, but has no high scores file; you
probably want to upgrade if possible.

Umoria 5.1.0-5.2.0: These versions can be played, but are somewhat
buggy.  If you run into an invisible, invincible monster which doesn't
move or attack, get off the level.  If you can FTP the sources or
executables, you should upgrade.

The U is often omitted from the names of the following Umoria versions.

Umoria 4.87/PC-Moria 4.87x: This version is based on the old VMS Moria.
It is relatively bug-free, but it doesn't have the features of the 5.x
versions, such as monster memory.  The save file format is incompatible
with 5.x, and several people have failed in attempts to write a
conversion program.

Umoria 4.85: A moderately buggy version, also based on VMS Moria.

Umoria/PC-Moria 4.83: An extremely buggy version, based on VMS Moria.
This version is essentially unplayable (see invisible doesn't work,
stores all close after 32768 turns, etc.)

The following versions are not compatible with Umoria, and Umoria
spoiler files may not apply to them.  I don't know much about these
versions.

UB Moria 5.0: Also known as VMS Moria 5.0, this is the current version
of VMS Moria.  It has more monsters, a Black Market, and other features.

Imoria 4.9: This is apparently a very good game, with new character
classes and other features.  It is now available for VMS and GNU+Linux only;
it has not yet been ported to DOS or other Unix platforms.

Amiga Moria 3.0: Although this version was originally based on 4.85, it
has many added monsters, features, and bugs (including items which make
you virtually invincible).

BOSS: This game changes the setting of Moria, but keeps many of the
items.  It is based on VMS Moria 5.0.

Pmoria: A version of Moria based on 5.5.0, with many enhancements.

Morgul: An expanded version of Moria, keeping a similar setting.  It is
based on Umoria 5.5.0.

Angband: Another expanded version of Moria with a similar setting.  It
is based on Umoria 5.2.1; current versions include some of the bug fixes
from later versions.  Although the basic game structure is similar to
Moria's, there have been many enhancements.  For more information, read
the USENET group rec.games.roguelike.angband.

Q8. I think I've found a bug; what should I do?   

When you are reporting a suspected bug, make sure to give the version
number and the system.  The bug report can be posted here or sent to me.
If someone else maintains the game on your machine, the bug report
should also be sent to him or her; the bug may be in a change on your
machine but not in my code.

If you have a patch for the bug, it would be best to send the patch by
email, so that I can check the patch before releasing it.

If you report a bug which has been fixed in the current version, I may
be able to send you a patch, or at least tell you that you can fix the
bug by upgrading.  If the bug hasn't been fixed, a good bug report may
make it easy to fix.

The following bugs have been reported with some frequency.  Fixes are
included where known; for 5.x versions, and 4.8x if you don't have a
character you need to preserve, the best fix is to upgrade.  All
versions are Umoria unless indicated otherwise.

All versions: Occasional rooms are created with no exit.  The only
attempt to fix this bug introduced others and had to be undone.

4.87-5.2.2: The game locks up if you wait in place for about 10,000
turns.  This can be fixed in the source; in the function
compact_monsters() in misc1.c, change "if (cur_dis > m_ptr.cdis)" to
"if (cur_dis < m_ptr.cdis)".  If you can't fix the bug, leave the level
if you see lots of "Compacting monsters..." messages.

4.87-5.2.1: Your carrying capacity decreases.  This cannot be fixed for
an individual character without hacking the savefile, or modifying the
program to fix the savefile.  To avoid it, don't use spikes, and don't
fight while wielding arrows in 4.87.

5.1.0-5.2.0: Invisible monsters which don't move or attack are sometimes
created.  Get off the level if you see one.

4.87: Monsters sometimes chase you in the wrong direction.  

4.87: Wands/spells of polymorph and drain life work only when you are
adjacent to the monster.

4.85: Several annoying bugs still exist, but this version is at least
playable.

4.83: Many bugs.  Upgrade.

Druid: Potions of Healing can heal you above your maximum hit points.

OS/2 Moria: Erick the Honest takes over all the stores eventually, and
refuses to stock expensive items.  This cannot be fixed by transferring
a character from OS/2 to other versions.

Amiga Moria 3.0: Some items make you extremely fast (and hungry).

Amiga Moria 3.0: The system crashes when you leave the game, because it
tries to close the screen without deactivating it.  Jump to the
workbench screen _instantly_ as the save (or exit) commences via [left
amiga + N] and activate the workbench screen via a mouseclick or [alt +
left amiga] (the keyboard shortcut for a mouse-click).

Q9. What are the special abilities of ego weapons?  Crowns?  Amulet of
the Magi?  Cloak of Protection? 

All version-dependent changes are marked in brackets.

Amulet of the Magi    free action, see invisible, searching, +3 AC.
                      [no searching bonus in 4.87]
Cloak of Protection   no special ability, just a larger bonus than usual.

Ego weapons:

(HA) Holy Avenger   +(1-4) str, +(1-4) AC, (SE), (SU), sustain stat,
                    see invisible.
(DF) Defender       stealth, regeneration, free action, see invisible,
                    feather fall, RF, RC, RL, RA, +(6-10) to AC
(SM) Slay Monster   Damage (x 2) vs. monsters, see invisible. [found in
                    4.87 only]
(SA) Slay Animal    Damage (x 2) vs. animals, [does not exist in 4.87;
                    has see invisible through 5.1.4]
(SD) Slay Dragon    Damage (x 4) vs. dragons.
(SE) Slay Evil      Damage (x 2) vs. evil monsters.
(SU) Slay Undead    Damage (x 3) vs. undead, [see invisible in 5.1.5 and later]
(FT) Flame Tongue   Damage (x 1.5) vs. monsters harmed by fire.
(FB) Frost Brand    Damage (x 1.5) vs. monsters harmed by cold.

A HA which is +1 to strength sustains strength; +2, intelligence; +3,
wisdom; +4, constitution (not dexterity).

Crown of the Magi     +(1-3) int, (RF), (RC), (RA), (RL)
                      [In 4.87, it had see invisible instead of RL]
Crown of Lordliness   +(1-3) wis, chr.
Crown of Might        +(1-3) str, dex, con, free action.
Crown of Seeing       see invisible, +(10-25) searching.
                      [+(2-5) to seach in 4.87]
Crown of Regeneration Regeneration.
Crown of Beauty       +(1-3) charisma.

Regeneration lets you recover mana and hit points at 1.5 times the
normal rate, but also makes you use up food much more quickly.

Free action prevents you from being slowed or paralyzed by monsters.

Q10. How much damage do spells and wands do?

Spell Name              4.87 damage     5.1.0 and later damage
Magic Missile           2d6             2d6
Stinking Cloud          8               12
Lightning Bolt          3d8             4d8
Lightning Ball          24              32
Frost Bolt              4d8             6d8
Frost/Cold Ball         32              48
Acid Ball               40              60
Fire Bolt               6d8             9d8
Fire Ball               48              72
Wand of Drain Life      50              75 [in 5.1.4 and later]

In 5.x only, a wand of wall building will do 4d8 damage to any creature
buried in the wall (except one that moves through walls), and will kill
any immobile creature.  On the creature's next turn, it will attempt to
move out of the wall, and if it is unable to do so, it will take 10d8
damage and dig its way out.

Everything below is the same in all versions.
Wand of Light/Staff of  2d8 (if sensitive)
Starlight               
Stone to Mud		100 (if sensitive)
Orb of Draining         3d6 + caster's level, double to evil creatures
Dispel Undead/Evil      1-60 from scroll or staff; 1 up to triple
                        caster's level from spell
Holy Word               Dispel evil for 1 up to quadruple caster's level

Notes:

All mage spells in 4.87 do the damage listed in the table above if cast
from a wand, and 1 point more if cast by a mage.
All ball spells do full damage for a direct hit, half damage one space
away, and 1/3 damage two spaces away.

Q11. What does spell Y do?

Non-obvious spell effects:

Mage spells:

Phase Door: short-range teleport.
Find Hidden Traps/Doors: also detects stairs.
Sleep I: sleep one monster in a given direction.
Recharge Item I: fewer charges than Recharge Item II, and more likely to
		 fail. 
Sleep II: sleep all monsters adjacent to player.
Sleep III: sleep all monsters with a line of sight to player (including
	   invisible ones). 
Word of Destruction: obliterates everything within 15 spaces of the
		     player; Balrog will teleport to another level.

Priest spells:

Bless: +2 to AC, and +5 to chance to hit (equivalent to +1-2/3 bonus on
       weapon) for a short time.
Blind Creature: blinded creatures wander around confused until they recover.
Portal: medium-range teleport.
Chant: double duration Bless.
Sanctuary: sleep creatures adjacent to player.
Protection from Evil: prevents any evil creature of the player's level
		      or lower from attacking the player.
Earthquake: causes random walls and ceilings in the area to collapse,
	    possibly injuring anything nearby.
Turn Undead: all undead of the player's level or lower, and some of
	     higher level, will attempt to flee [in 5.5.0 and earlier
             versions, they will be confused]
Prayer: quadruple duration Bless.
Dispel Undead/Evil: affects all undead/evil within line of sight (even
		    invisble ones in 5.x versions), damage is from 1
		    up to 3x player's level, 1-60 from scroll or staff.
Glyph of Warding: creates a glyph which monsters cannot enter, but have 
		  a small chance of breaking.
Holy Word: heals player completely, cures poison and fear, and dispels
	   evil for 1 to 4x player's level.  [In 5.5.1 and later
	   versions, also restores all stats, and makes player
	   invulnerable for 3 turns.]

Q12. On what level do you find X?   

Where important objects are found:

In 4.87, 1/20 of items are chosen as if you were on level 50.  In 5.1
and all later versions, 1/12 of items are chosen as if you were on a
deeper level, which has (current level/50) chance of being level 50;
this check is not made in town.  This affects only the type of item, not
its enchantment.

Items become somewhat less common as you go deeper than the indicated
levels; however, if you can survive down there, this is compensated for
by the fact that there are more treasures on deeper levels.

Item type			Level
Ego weapons, special armor,	Progressively more common as you get
boots, gloves, helmets		deeper, all the way to level 55
Healing potion			12
Gain stat potions		25
Restore mana potion		25
Invulnerability potion		40
Gain experience potion		50
Genocide scroll			35
Destruction scroll		40
Rune of Protection scroll	50
Mass Genocide scroll		50
Amulets of wisdom, charisma	20
Gain str/int/dex/con rings	30
Amulet of the magi		50
Ring of speed			50
Staff of speed			40
Staff of mass polymorph		46
Staff of dispel evil		49
Staff of destruction		50
Wand of clone monster		15 [2 in 4.87]
Wand of drain life		50

Q13. How many attacks can I get with this weapon?

Here is the table (for 5.x) for the number of blows for a given strength
and dexterity.  If your strength or dexterity is 18+xx, that is stored
as 18/xx; thus, for example, you need an 18/90 strength to use the
bottom row of the table with a katana (12 pounds).

If you don't know the weight of a weapon, set the option "Show weights
in inventory."

/* used to calculate the number of blows the player gets in combat */
int8u blows_table[7][6] = {
/* STR/W:	   9  18  67 107 117 118   : DEX */
/* <2 */	{  1,  1,  1,  1,  1,  1 },
/* <3 */	{  1,  1,  1,  1,  2,  2 },
/* <4 */	{  1,  1,  1,  2,  2,  3 },
/* <5 */	{  1,  1,  2,  2,  3,  3 },
/* <7 */	{  1,  2,  2,  3,  3,  4 },
/* <9 */	{  1,  2,  2,  3,  4,  4 },
/* >9 */	{  2,  2,  3,  3,  4,  4 }
};


Q14. How do you kill an ancient multi-hued dragon?  

Usually, you don't want to try; one gas breath from a full-strength AMHD
does 693 damage, with no resistance.

If you can get to speed 3 (one permanent speed item, and either another
permanent speed item or a haste self spell or staff), you can try this
technique.  First, create (or find in a maze room) a wall with one open
space on all four sides.

   .
  .#.
   .

Stand on one side, with the dragon on the other side.  When the dragon
moves adjacent to you, attack it once, and then hide behind the pillar.
The dragon can't see you, so it won't breathe, and will instead chase
you to another side.  Now attack once, and hide again, and so on until
the dragon is finished.

Q15. How do you kill an emperor lich?  

You can kill an emperor lich if you can get to speed 2, which is its
speed.  A mage or ranger can do this with the spell of haste self;
anyone else needs a staff of speed, potion of haste self, or permanent
speed item.  You will also need about 10 cure critical wounds or cure
serious wounds potions, and some item giving you free action.

You also need some ranged spell attack.  Liches take double damage from
lightning in 5.x versions, so the spell of lightning bolt or wand of
lightning balls is a good choice.  Rogues and warriors will need several
wands, with a total of about 30 charges to guarantee that they can kill
the lich with them.  A priest or paladin has Orb of Draining, which is
even better.

Now, try to line up with the lich while you are not adjacent to it,
either in a room or a corridor.  This gives you a chance to cast your
spell.  The lich will get one action.  If it cast a spell and you
resisted, or the spell didn't do anything harmful, you have another
chance.  If you were confused or blinded, drink a cure wounds potion;
the lich isn't adjacent to you, so it can't hurt you.  If the lich moved
and is now adjacent to you, move back.  Try to avoid getting cornered,
and phase door or portal away if you are.  A priest can make this easier
by putting down a glyph of warding, but this must be done *before* the
lich chases you across the glyph.  (Don't stand on the glyph; it isn't
foolproof.)

If you run low on mana and don't have a wand, teleport out and come back
later to finish the job.

A priest with glyph of warding can also set up the following
configuration (the exact length doesn't matter as long as you are within
spell range):

#L#####
#^^...@
#######

The lich cannot cast spells from this position, because it cannot see
you.  As long as it doesn't break the glyphs, you are safe, and can fire
Orb of Draining down the corridor; the lich will take some damage each
time.  If the lich breaks either glyph, run or teleport out, and
continue the battle elsewhere.

I do not advise trying this technique against an AMHD; it will probably
break a glyph before the battle is over, and if your teleport spell
fails, or if you haven't hasted yourself, the AMHD gets a chance to
breathe.

An emperor lich has 1520 hit points, plus anything additional that it
gains by draining mana (6 points per mana point drained) and charges (40
points per charge).  Never let it attack you in melee, because it can
destroy your wands, healing itself in the process, as well as draining
your experience and dexterity.

If you can get to speed 3, faster than the lich, it is easy to kill;
just fight, move back, fight, move back, and so on.  You will still need
a lot of cure wounds potions, unless you let it chase you around a
pillar, as in the AMHD technique.

Q16. What is the grape jelly trick?  Does it work in Umoria 5.x?  

The Grape Jelly trick is a spoiler/workaround/trick which is no longer
necessary in 5.1 and later versions.  

In 4.87, when your intelligence and constitution changed, your mana and
hit points did not change.  Thus, in order to get the benefit of the
increased values, you have to let a grape jelly (or other creature, but
grape jellies are otherwise harmless) drain you to a low level, and then
drink restore life levels potions to go back up with the increased
stats.

Q17. I don't like haggling; can I change the source code to turn it off?

If you have the source code for version 5.7, you can turn off haggling in
the game options (press "=").

If you have the source code for any 5.x version before 5.7, you can turn off
haggling with a simple change.  Here is the change you would need to make.
(Note: This is *not* an official patch.)

In the source file store1.c, this is the routine for determining whether
you need to haggle.  You can change the function, or simply change the
return(flagnoneed) to return(TRUE) to eliminate all haggling.  The code
here is from versions 5.5.1 and 5.5.2; the text of the function is
slightly different in earlier versions.

int noneedtobargain(store_num, minprice)
int store_num;
int32 minprice;
{
  register int flagnoneed;
  int bargain_record;
  register store_type *s_ptr;

  s_ptr = &store[store_num];
  if (s_ptr->good_buy == MAX_SHORT)
    return TRUE;
  bargain_record = (s_ptr->good_buy - 3 * s_ptr->bad_buy - 5);
  flagnoneed = ((bargain_record > 0)
		&& ((long)bargain_record * (long)bargain_record
		    > minprice/50));
  return (flagnoneed);
}

Q18. How do you create objects in wizard mode?

You will need the source; if you have only executables, get the source
files object_constant.h, treasure_type.h and treasure_tables.c from the 
archive, which contain the necessary definitions.  This is an explanation of 
some of the parameters.

After entering wizard mode with ^W, hit the @ key.  You will be asked for a
series of data elements that comprise an object in Umoria.

Tval: This is the main category of objects in the game.  It is defined in 
object_constant.h; it is the value for the item type.  For example, 
TV_WAND is 65, and TV_SECRET_DOOR is 109.  An object is everything on the 
screen that the character can act upon, except for walls and creatures.

Tchar: The character used to represent this object on the screen; it should 
usually be proper for the item type.

Subval: This is the subcategory for objects in the game.  It identifies the 
specific item.  If you are duplicating an item from the item list, use the 
same subval (and tval) as that item; otherwise, don't.  Use subvals 0-63 for 
items that shouldn't stack, 64-127 for items that should always stack 
(potions and scrolls), 193 or more for items that are generated in a group, 
and should stack as that group (arrows).

Weight: In tenths of a pound.

P1: Used for all special bonuses which don't appear elsewhere:
bonus to stats/searching/stealth/speed, which stat to sustain (warning:
constitution is 4 and dexterity 5), tunneling value, food value, light
value of a lamp, torch, or flask of oil.  
For missiles, different values of P1 distinguish different groups of
missiles; use small negative numbers if you create groups as a wizard.
For bows, slings, and crossbows, the values identify the weapon type;
use the same value that is used for the corresponding weapon in
treasure_tables.c.

Flags: A hexadecimal number which contains:
for wearable items, all special effects (bits beginning with TR_ in
constant.h).
for chests, trap flags (CH_ bits in constant.h) and treasure flags (CM_
bits in constant.h).  The CM_WIN flag is cleared when you open a chest,
so you can't create a chest with that bit set in order to get an instant
win.
for potions/scrolls/staffs/wands, the effects of using the item (see the
items in treasure_tables.c).  Many potions have multiple effects (cure light
wounds also cures blindness). 
for books, which spells are in the book (spell 1 is the units bit).

Level: Level on which the item would be found.  This affects the
difficulty of using wands and staffs.

The object will have no name, except for the inscription {wizard item},
and possibly a type name, such as "Potion of"; you can change the
inscription.

